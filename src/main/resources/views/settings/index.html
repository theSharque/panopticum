<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{layout :: layout(~{::main})}">
<head></head>
<body>
<main th:fragment="main" class="main-content">
    <h1 th:text="${msg['settings.title']}">Add connection</h1>

    <div class="form-group">
        <label for="connection-type" th:text="${msg['settings.connectionType']}">Connection type</label>
        <select id="connection-type" class="connection-type-select">
            <option value="" th:text="${msg['settings.selectType']}">Select type</option>
            <option value="postgresql">PostgreSQL</option>
            <option value="mongodb">MongoDB</option>
            <option value="redis">Redis</option>
            <option value="clickhouse">ClickHouse</option>
        </select>
    </div>

    <div id="form-postgres" class="connection-form-block" hidden>
        <form id="connection-form-postgres" action="/settings/add-postgres" method="post" class="add-connection-form"
              hx-post="/settings/add-postgres"
              hx-target="#sidebar"
              hx-swap="outerHTML">
            <div class="form-group">
                <label for="name" th:text="${msg['common.name']}">Name</label>
                <input type="text" id="name" name="name" required th:attr="placeholder=${msg['settings.placeholderNamePg']}">
            </div>
            <div class="form-group">
                <label for="host" th:text="${msg['settings.host']}">Host</label>
                <input type="text" id="host" name="host" required placeholder="localhost" value="localhost">
            </div>
            <div class="form-group">
                <label for="port" th:text="${msg['settings.port']}">Port</label>
                <input type="number" id="port" name="port" value="5432">
            </div>
            <div class="form-group">
                <label for="database" th:text="${msg['settings.database']}">Database</label>
                <input type="text" id="database" name="database" required placeholder="mydb">
            </div>
            <div class="form-group">
                <label for="username" th:text="${msg['settings.username']}">Username</label>
                <input type="text" id="username" name="username" required placeholder="user">
            </div>
            <div class="form-group">
                <label for="password" th:text="${msg['settings.password']}">Password</label>
                <input type="password" id="password" name="password" placeholder="password">
            </div>
            <div class="form-actions">
                <span id="test-indicator-pg" class="connection-test-indicator" aria-hidden="true" th:text="${msg['settings.testing']}">Checking...</span>
                <button type="button" class="btn-check"
                        hx-post="/settings/test-postgres"
                        hx-include="#connection-form-postgres"
                        hx-target="#connection-test-result"
                        hx-swap="innerHTML show:bottom"
                        hx-indicator="#test-indicator-pg"
                        th:text="${msg['settings.test']}">Test</button>
                <button type="submit" th:text="${msg['settings.add']}">Add</button>
            </div>
            <div id="connection-test-result" class="connection-test-result"></div>
        </form>
    </div>

    <div id="form-mongo" class="connection-form-block" hidden>
        <form id="connection-form-mongo" action="/settings/add-mongo" method="post" class="add-connection-form"
              hx-post="/settings/add-mongo"
              hx-target="#sidebar"
              hx-swap="outerHTML">
            <div class="form-group">
                <label for="name-mongo" th:text="${msg['common.name']}">Name</label>
                <input type="text" id="name-mongo" name="name" required th:attr="placeholder=${msg['settings.placeholderNameMongo']}">
            </div>
            <div class="form-group">
                <label for="host-mongo" th:text="${msg['settings.host']}">Host</label>
                <input type="text" id="host-mongo" name="host" required placeholder="localhost" value="localhost">
            </div>
            <div class="form-group">
                <label for="port-mongo" th:text="${msg['settings.port']}">Port</label>
                <input type="number" id="port-mongo" name="port" value="27017">
            </div>
            <div class="form-group">
                <label for="database-mongo" th:text="${msg['settings.database']}">Database</label>
                <input type="text" id="database-mongo" name="database" placeholder="admin">
            </div>
            <div class="form-group">
                <label for="username-mongo" th:text="${msg['settings.username']}">Username</label>
                <input type="text" id="username-mongo" name="username" placeholder="user">
            </div>
            <div class="form-group">
                <label for="password-mongo" th:text="${msg['settings.password']}">Password</label>
                <input type="password" id="password-mongo" name="password" placeholder="password">
            </div>
            <div class="form-actions">
                <span id="test-indicator-mongo" class="connection-test-indicator" aria-hidden="true" th:text="${msg['settings.testing']}">Checking...</span>
                <button type="button" class="btn-check"
                        hx-post="/settings/test-mongo"
                        hx-include="#connection-form-mongo"
                        hx-target="#connection-test-result-mongo"
                        hx-swap="innerHTML show:bottom"
                        hx-indicator="#test-indicator-mongo"
                        th:text="${msg['settings.test']}">Test</button>
                <button type="submit" th:text="${msg['settings.add']}">Add</button>
            </div>
            <div id="connection-test-result-mongo" class="connection-test-result"></div>
        </form>
    </div>

    <div id="form-redis" class="connection-form-block" hidden>
        <form id="connection-form-redis" action="/settings/add-redis" method="post" class="add-connection-form"
              hx-post="/settings/add-redis"
              hx-target="#sidebar"
              hx-swap="outerHTML">
            <div class="form-group">
                <label for="name-redis" th:text="${msg['common.name']}">Name</label>
                <input type="text" id="name-redis" name="name" required th:attr="placeholder=${msg['settings.placeholderNameRedis']}">
            </div>
            <div class="form-group">
                <label for="host-redis" th:text="${msg['settings.host']}">Host</label>
                <input type="text" id="host-redis" name="host" required placeholder="localhost" value="localhost">
            </div>
            <div class="form-group">
                <label for="port-redis" th:text="${msg['settings.port']}">Port</label>
                <input type="number" id="port-redis" name="port" value="6379">
            </div>
            <div class="form-group">
                <label for="database-redis" th:text="${msg['settings.databaseRedis']}">DB (0â€“15)</label>
                <input type="number" id="database-redis" name="database" placeholder="0" value="0" min="0" max="15">
            </div>
            <div class="form-group">
                <label for="password-redis" th:text="${msg['settings.password']}">Password</label>
                <input type="password" id="password-redis" name="password" placeholder="password">
            </div>
            <div class="form-actions">
                <span id="test-indicator-redis" class="connection-test-indicator" aria-hidden="true" th:text="${msg['settings.testing']}">Checking...</span>
                <button type="button" class="btn-check"
                        hx-post="/settings/test-redis"
                        hx-include="#connection-form-redis"
                        hx-target="#connection-test-result-redis"
                        hx-swap="innerHTML show:bottom"
                        hx-indicator="#test-indicator-redis"
                        th:text="${msg['settings.test']}">Test</button>
                <button type="submit" th:text="${msg['settings.add']}">Add</button>
            </div>
            <div id="connection-test-result-redis" class="connection-test-result"></div>
        </form>
    </div>

    <div id="form-clickhouse" class="connection-form-block" hidden>
        <form id="connection-form-clickhouse" action="/settings/add-clickhouse" method="post" class="add-connection-form"
              hx-post="/settings/add-clickhouse"
              hx-target="#sidebar"
              hx-swap="outerHTML">
            <div class="form-group">
                <label for="name-clickhouse" th:text="${msg['common.name']}">Name</label>
                <input type="text" id="name-clickhouse" name="name" required th:attr="placeholder=${msg['settings.placeholderNameCh']}">
            </div>
            <div class="form-group">
                <label for="host-clickhouse" th:text="${msg['settings.host']}">Host</label>
                <input type="text" id="host-clickhouse" name="host" required placeholder="localhost" value="localhost">
            </div>
            <div class="form-group">
                <label for="port-clickhouse" th:text="${msg['settings.port']}">Port</label>
                <input type="number" id="port-clickhouse" name="port" value="8123">
            </div>
            <div class="form-group">
                <label for="database-clickhouse" th:text="${msg['settings.database']}">Database</label>
                <input type="text" id="database-clickhouse" name="database" placeholder="default" value="default">
            </div>
            <div class="form-group">
                <label for="username-clickhouse" th:text="${msg['settings.username']}">Username</label>
                <input type="text" id="username-clickhouse" name="username" placeholder="default">
            </div>
            <div class="form-group">
                <label for="password-clickhouse" th:text="${msg['settings.password']}">Password</label>
                <input type="password" id="password-clickhouse" name="password" placeholder="password">
            </div>
            <div class="form-actions">
                <span id="test-indicator-clickhouse" class="connection-test-indicator" aria-hidden="true" th:text="${msg['settings.testing']}">Checking...</span>
                <button type="button" class="btn-check"
                        hx-post="/settings/test-clickhouse"
                        hx-include="#connection-form-clickhouse"
                        hx-target="#connection-test-result-clickhouse"
                        hx-swap="innerHTML show:bottom"
                        hx-indicator="#test-indicator-clickhouse"
                        th:text="${msg['settings.test']}">Test</button>
                <button type="submit" th:text="${msg['settings.add']}">Add</button>
            </div>
            <div id="connection-test-result-clickhouse" class="connection-test-result"></div>
        </form>
    </div>

    <script>
        document.getElementById('connection-type').addEventListener('change', function () {
            var type = this.value;
            document.getElementById('form-postgres').hidden = type !== 'postgresql';
            document.getElementById('form-mongo').hidden = type !== 'mongodb';
            document.getElementById('form-redis').hidden = type !== 'redis';
            document.getElementById('form-clickhouse').hidden = type !== 'clickhouse';
        });
    </script>

    <h2 th:text="${msg['settings.addedConnections']}">Saved connections</h2>
    <p th:text="${msg['settings.connectionsInMenu']}">Connections are shown in the menu on the left.</p>
</main>
</body>
</html>
